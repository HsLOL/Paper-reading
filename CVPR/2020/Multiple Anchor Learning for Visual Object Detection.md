#### Multiple Anchor Learning for Visual Object Detection

**发现的问题**

* 认为目标检测任务中分类和回归网络是根据锚框分别独立优化的，但是这种优化过程会造成有的锚框具备优良的回归特性，但是置信度不高，在推理过程中被NMS算法抑制掉了。

> 文章中的插图描述了这种现象，左图分类得分高的锚框定位差，定位好的锚框得分不高，即分类和回归的得分并不一致。
>
> 而文章提出的方法可以使分类得分与定位结果保持一致

![image-20210517204643697](C:\Users\fzh\AppData\Roaming\Typora\typora-user-images\image-20210517204643697.png)

**解决的思路**

* 文章把预测得分最高的锚框找到，扰乱他们的特征，使检测器对他们的预测得分下降，这样就可以使其他定位好但得分不高的锚框也有机会参与到训练过程中。自己想了一下就相当于网络也考虑到了那些定位好分类得分差的框，也考虑到了定位差分类得分高的框，相当于网络看到了这两种情况，看的情况多了，自然会在推理时都进行考虑。

## 一、采用的网络

采用RetinaNet网络

## 二、提出的方法

**首先文章给出了目标检测器通过更新网络参数使分类网络的预测得分和回归网络的得分最大**。公式1代表分类得分，公式2代表回归得分。

![image-20210517205907841](C:\Users\fzh\AppData\Roaming\Typora\typora-user-images\image-20210517205907841.png)

![image-20210517205939816](C:\Users\fzh\AppData\Roaming\Typora\typora-user-images\image-20210517205939816.png)

**然后介绍了论文提出的`MAL`的流程**

1. 对每个真值，计算所有锚框与它的IoU，找到大于阈值的所有锚框，并选择前top-k个锚框放到这个真值对应的`锚框bag`里。

2. 然后根据公式3找到每个`锚框bag`里面最大的锚框。

   ![image-20210517213258882](C:\Users\fzh\AppData\Roaming\Typora\typora-user-images\image-20210517213258882.png)

训练过程中每个`锚框bag`里面锚框的个数遵循下面的公式

![image-20210517213534525](C:\Users\fzh\AppData\Roaming\Typora\typora-user-images\image-20210517213534525.png)

3. 锚框的抑制过程

根据得分最大的锚框得到类激活图，然后对类激活图中信息的重要程度生成一个`扰动矩阵`（可能是扰动矩阵），然后将扰动矩阵与特征图相乘得到扰动后特征图（可以理解成检测器就是根据未扰动的特征图某部分的特征找到这个锚框，现在这个锚框对应的位置被扰动了，下次检测器就对这个位置的得分就降低了，为其他得分低但定位好的锚框提供了机会）

4. 迭代训练

   用正类锚框对网络参数进行更新，然后网络重复操作1和2，但是对扰动后的图去计算新的得分？

5. 效果感觉就是检测器必须提高对特征的识别能力，才能准确的检测出物体

![image-20210517215323945](C:\Users\fzh\AppData\Roaming\Typora\typora-user-images\image-20210517215323945.png)

通过结果，提出的方法使网络更加关注有用的信息，抑制那些无用的信息。























